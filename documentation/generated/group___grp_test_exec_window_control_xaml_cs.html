<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>TestExecWindow: TestExecWindowControl.xaml.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MyStyles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TestExecWindow
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___grp_test_exec_window_control_xaml_cs.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TestExecWindowControl.xaml.cs<div class="ingroups"><a class="el" href="group___grp_design.html">Internal Design</a> &raquo; <a class="el" href="group___grp_sources.html">Source files</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Copyright(C) 2016  Gerald Fahrnholz</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">//    it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">//    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment">//    (at your option) any later version.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><span class="comment">//    GNU General Public License for more details.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">//    along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    Contact: http://www.gerald-fahrnholz.eu/impressum.php</span></div>
<div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>TestExecWin</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> System.Diagnostics.CodeAnalysis;</div>
<div class="line">    <span class="keyword">using</span> System.Diagnostics;</div>
<div class="line">    <span class="keyword">using</span> System.Windows;</div>
<div class="line">    <span class="keyword">using</span> System.Windows.Controls;</div>
<div class="line">    <span class="keyword">using</span> System;</div>
<div class="line">    <span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">class </span>MyListItem</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">string</span> displayString;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> idx;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> MyListItem(<span class="keywordtype">int</span> in_idx, <span class="keywordtype">string</span> in_displayString)</div>
<div class="line">        {</div>
<div class="line">            idx = in_idx;</div>
<div class="line">            displayString = in_displayString;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">string</span> ToString()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> displayString;</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><span class="comment">    /// Interaction logic for TestExecWindowControl.</span></div>
<div class="line"><span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">public</span> <span class="keyword">partial class </span>TestExecWindowControl : UserControl</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">private</span> ProjectInfo m_projectInfo = <span class="keyword">new</span> ProjectInfo();</div>
<div class="line">        <span class="keyword">private</span> IMainEvents m_mainEvents;</div>
<div class="line">        <span class="keyword">private</span> IEventReceiver m_evenReceiver;</div>
<div class="line">        <span class="keyword">private</span> IExecute m_executor;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_useDebugger = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">enum</span> RunMode { TEST_GROUPS, TEST_FUNCS, TEST_APPS, TEST_STARTUP_PROJECT };</div>
<div class="line">        <span class="keyword">private</span> RunMode m_curRunMode = RunMode.TEST_STARTUP_PROJECT;</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span>[] m_numExecutedTests = <span class="keyword">new</span> <span class="keywordtype">int</span>[] { 0, 0, 0, 0 };</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span>[] m_numFailedTests = <span class="keyword">new</span> <span class="keywordtype">int</span>[] { 0, 0, 0, 0 };</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span>[] m_totalNumTestsToExecute = <span class="keyword">new</span> <span class="keywordtype">int</span>[] { 0, 0, 0, 0 };</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_stoppedByUser = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keyword">private</span> System.Windows.Forms.Timer m_executionTimer = <span class="keyword">new</span> System.Windows.Forms.Timer();</div>
<div class="line">        <span class="keyword">enum</span> WaitMode { WAIT_ENDLESS, WAIT_30_SEC, WAIT_1_MIN, WAIT_2_MIN, WAIT_5_MIN, WAIT_10_MIN, WAIT_20_MIN, WAIT_30_MIN, WAIT_40_MIN, WAIT_60_MIN };</div>
<div class="line">        <span class="keyword">private</span> WaitMode m_waitMode = (WaitMode)Properties.Settings.Default.IdxMaxWaitTime;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> InitForTestExecution(RunMode in_runMode, <span class="keywordtype">int</span> in_numTestsToExecute)</div>
<div class="line">        {</div>
<div class="line">            m_stoppedByUser = <span class="keyword">false</span>;</div>
<div class="line">            m_idxRunAllTestGroups = -1;</div>
<div class="line">            m_idxRunAllTestFuncs = -1;</div>
<div class="line">            m_idxRunAllTestApps = -1;</div>
<div class="line">            m_curRunMode = in_runMode;</div>
<div class="line">            <span class="keywordtype">int</span> idx = (int)m_curRunMode;</div>
<div class="line">            m_numExecutedTests[idx] = 0;</div>
<div class="line">            m_numFailedTests[idx] = 0;</div>
<div class="line">            m_totalNumTestsToExecute[idx] = in_numTestsToExecute;</div>
<div class="line">            m_state[idx] = State.RUNNING;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">enum</span> ColVisibility { BOTH, LEFT, RIGHT };</div>
<div class="line">        ColVisibility m_colVisibility = (ColVisibility)Properties.Settings.Default.IdxGroupsAndFuncs;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">enum</span> SortOrder { AS_READ_FROM_FILE, REVERSE_READ, ALPHA, REVERSE_ALPHA };</div>
<div class="line">        <span class="keywordtype">bool</span> m_optionsVisible = Properties.Settings.Default.OptionsAreVisible;</div>
<div class="line">        <span class="keywordtype">bool</span> m_logVisible = Properties.Settings.Default.LogIsVisible;</div>
<div class="line">        SortOrder m_sortOrder = (SortOrder)Properties.Settings.Default.IdxSortOrder;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">enum</span> State { IDLE, RUNNING, SUCCEEDED, FAILED };</div>
<div class="line">        <span class="keyword">private</span> State[] m_state = <span class="keyword">new</span> State[] { State.IDLE, State.IDLE, State.IDLE, State.IDLE };</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> m_idxRunAllTestGroups = -1;</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> m_idxRunAllTestFuncs = -1;</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> m_idxRunAllTestApps = -1;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">enum</span> ExpImpMode { EXPORT_TO_FILE = 1, IMPPORT_FROM_FILE, IMPORT_FROM_SOLUTION, IMPORT_TEST_GROUPS_FROM_STARTUP_PROJECT, IMPORT_VISIBLE_TEST_FUNCS_FROM_STARTUP_PROJECT };</div>
<div class="line">        <span class="keyword">private</span> List&lt;string&gt; m_currentTestApps = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">        <span class="keyword">private</span> List&lt;string&gt; m_dataDescTestApps;</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> m_idxCurrentTestApps = Properties.Settings.Default.IdxCurrentTestApps;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> System.Windows.Media.Brush m_originalBrushWindow;</div>
<div class="line">        <span class="keyword">private</span> System.Windows.Media.Brush m_originalBrushTextBlock;</div>
<div class="line">        <span class="keyword">private</span> System.Windows.Media.Brush m_originalBrushButton;</div>
<div class="line">        <span class="keyword">private</span> System.Windows.Threading.DispatcherTimer m_refreshTimer = <span class="keyword">new</span> System.Windows.Threading.DispatcherTimer();</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">bool</span> m_refreshTimerIsActive = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Is basically a copy of m_projectInfo.testGroups/testFuncs but this copy may be sorted</span></div>
<div class="line">        <span class="comment">// according  to user requests, The original collection stores the elements in the</span></div>
<div class="line">        <span class="comment">// order as read from files.</span></div>
<div class="line">        System.Collections.Generic.List&lt;TestGroupEntry&gt; m_testGroups;</div>
<div class="line">        System.Collections.Generic.List&lt;TestFuncEntry&gt; m_testFuncs;</div>
<div class="line">        HashSet&lt;string&gt; m_selectedTestGroups;</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><span class="comment">        /// Initializes a new instance of the &lt;see cref=&quot;TestExecWindowControl&quot;/&gt; class.</span></div>
<div class="line"><span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> TestExecWindowControl(IMainEvents in_mainEvents, IEventReceiver in_eventReceiver, IExecute in_executor)</div>
<div class="line">        {</div>
<div class="line">            this.InitializeComponent();</div>
<div class="line">            m_mainEvents = in_mainEvents;</div>
<div class="line">            m_evenReceiver = in_eventReceiver;</div>
<div class="line">            m_executor = in_executor;</div>
<div class="line">            m_executionTimer.Enabled = <span class="keyword">false</span>;</div>
<div class="line">            m_executionTimer.Tick += <span class="keyword">new</span> EventHandler(OnExecutionTimeout);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line">            {</div>
<div class="line">                m_state[i] = State.IDLE;</div>
<div class="line">            }</div>
<div class="line">            m_originalBrushWindow = mainGrid.Background;</div>
<div class="line">            m_originalBrushTextBlock = txtInfoStarArgTestGroup.Background;</div>
<div class="line">            m_originalBrushButton = btnRunTestAll.Background;</div>
<div class="line"></div>
<div class="line">            lstTestGroups.SelectionMode = SelectionMode.Extended;</div>
<div class="line">            lstTestFuncs.SelectionMode = SelectionMode.Extended;</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;test groups and funcs&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;only test groups&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;only test funcs&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="comment">//var comboBox = sender as ComboBox;</span></div>
<div class="line">                cbxColVisibility.ItemsSource = data;</div>
<div class="line">                cbxColVisibility.SelectedIndex = (int)m_colVisibility;</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;sort as read&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;reverse read order&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;sort A-&gt;Z&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;sort Z-&gt;A&quot;</span>);</div>
<div class="line"></div>
<div class="line">                cbxSortOrder.ItemsSource = data;</div>
<div class="line">                cbxSortOrder.SelectedIndex = (int)m_sortOrder;</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;show log&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;hide log&quot;</span>);</div>
<div class="line"></div>
<div class="line">                cbxLogVisibility.ItemsSource = data;</div>
<div class="line">                cbxLogVisibility.SelectedIndex = m_logVisible ? 0 : 1;</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;regular output&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;verbous output&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;detailed output&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">int</span> outputLevel = Properties.Settings.Default.IdxOutputLevel + 1;</div>
<div class="line">                cbxOutputLevel.ItemsSource = data;</div>
<div class="line">                cbxOutputLevel.SelectedIndex = outputLevel - 1;</div>
<div class="line"></div>
<div class="line">                m_mainEvents.OnSetOutputLevel(outputLevel);</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;leak check&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;no leak check&quot;</span>);</div>
<div class="line"></div>
<div class="line">                cbxMemLeakCheck.ItemsSource = data;</div>
<div class="line">                <span class="keywordtype">bool</span> leakCheck = Properties.Settings.Default.CheckForMemoryLeaks;</div>
<div class="line">                cbxMemLeakCheck.SelectedIndex = leakCheck ? 0 : 1;</div>
<div class="line"></div>
<div class="line">                m_executor.SetMemLeakCheck(leakCheck);</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app without time limit&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 30 sec&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 1 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 2 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 5 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 10 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 20 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 30 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 40 min&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;wait for test app max 60 min&quot;</span>);</div>
<div class="line"></div>
<div class="line">                cbxMaxExecutionTime.ItemsSource = data;</div>
<div class="line">                cbxMaxExecutionTime.SelectedIndex = (int)m_waitMode;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            {</div>
<div class="line">                List&lt;string&gt; data = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;BOOST options:&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;--detect_memory_leak=0&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;--log_level=test_suite&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;TTB Runner options:&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;-- -checkForMemLeaks OFF&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;-- -help&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;custom options:&quot;</span>);</div>
<div class="line">                data.Add(<span class="stringliteral">&quot;-- -prefixEvents TTB_EXP&quot;</span>);</div>
<div class="line"></div>
<div class="line">                cbxDefaultArgs.ItemsSource = data;</div>
<div class="line">                cbxDefaultArgs.SelectedIndex = 0;</div>
<div class="line">                cbxDefaultArgs.IsEditable = <span class="keyword">true</span>;</div>
<div class="line">                cbxDefaultArgs.Text = Properties.Settings.Default.GeneralCmdLineArgs;</div>
<div class="line">            }</div>
<div class="line">            {</div>
<div class="line">                m_dataDescTestApps = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps1);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps2);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps3);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps4);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps5);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps6);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps7);</div>
<div class="line">                m_dataDescTestApps.Add(Properties.Settings.Default.DescTestApps8);</div>
<div class="line"></div>
<div class="line">                cbxDescTestApps.ItemsSource = m_dataDescTestApps;</div>
<div class="line">                cbxDescTestApps.SelectedIndex = m_idxCurrentTestApps;</div>
<div class="line">                cbxDescTestApps.IsEditable = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnMoreOptions_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            m_optionsVisible = !m_optionsVisible;</div>
<div class="line">            Properties.Settings.Default.OptionsAreVisible = m_optionsVisible;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            RefreshDisplay();</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><span class="comment">        /// Handles click on the button by displaying a message box.</span></div>
<div class="line"><span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><span class="comment">        /// &lt;param name=&quot;sender&quot;&gt;The event sender.&lt;/param&gt;</span></div>
<div class="line"><span class="comment">        /// &lt;param name=&quot;e&quot;&gt;The event args.&lt;/param&gt;</span></div>
<div class="line"><span class="comment"></span>        [SuppressMessage(<span class="stringliteral">&quot;Microsoft.Globalization&quot;</span>, <span class="stringliteral">&quot;CA1300:SpecifyMessageBoxOptions&quot;</span>, Justification = <span class="stringliteral">&quot;Sample code&quot;</span>)]</div>
<div class="line">        [SuppressMessage(<span class="stringliteral">&quot;StyleCop.CSharp.NamingRules&quot;</span>, <span class="stringliteral">&quot;SA1300:ElementMustBeginWithUpperCaseLetter&quot;</span>, Justification = <span class="stringliteral">&quot;Default event handler naming pattern&quot;</span>)]</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunTestAll_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_useDebugger)</div>
<div class="line">                {</div>
<div class="line">                    m_mainEvents.OnStartDebugging(cbxDefaultArgs.Text);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// regular execution</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_STARTUP_PROJECT] == State.RUNNING)</div>
<div class="line">                    {</div>
<div class="line">                        StopExecution();</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_STARTUP_PROJECT, 1);</div>
<div class="line">                        RefreshState();</div>
<div class="line">                        StartProcess(m_projectInfo.GetExePath(), cbxDefaultArgs.Text, m_projectInfo.targetDirPath);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunSelectedTestGroup_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_useDebugger)</div>
<div class="line">                {</div>
<div class="line">                    m_mainEvents.OnStartDebugging(txtStartArgTestGroup.Text + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// regular execution</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_GROUPS] == State.RUNNING)</div>
<div class="line">                    {</div>
<div class="line">                        StopExecution();</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_GROUPS, 1);</div>
<div class="line">                        RefreshState();</div>
<div class="line">                        StartProcess(m_projectInfo.GetExePath(), txtStartArgTestGroup.Text + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text, m_projectInfo.targetDirPath);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunAllTestGroups_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_GROUPS] == State.RUNNING)</div>
<div class="line">                {</div>
<div class="line">                    StopExecution();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (lstTestGroups.Items.Count &gt; 0)</div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_GROUPS, lstTestGroups.Items.Count);</div>
<div class="line">                        m_idxRunAllTestGroups = 0;</div>
<div class="line">                        StartTestGroup(0);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnGoToSrcTestGroup_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (lstTestGroups.SelectedItem == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;No test group selected!&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;GoTo src: selIndex=&quot;</span> + lstTestGroups.SelectedIndex);</div>
<div class="line">                    m_mainEvents.OnOpenSourceFile(m_testGroups[lstTestGroups.SelectedIndex].fileFullPath,</div>
<div class="line">                        m_testGroups[lstTestGroups.SelectedIndex].lineNum);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunSelectedTestFunc_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_useDebugger)</div>
<div class="line">                {</div>
<div class="line">                    m_mainEvents.OnStartDebugging(txtStartArgTestFunc.Text + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// regular execution</span></div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_FUNCS] == State.RUNNING)</div>
<div class="line">                    {</div>
<div class="line">                        StopExecution();</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_FUNCS, 1);</div>
<div class="line">                        RefreshState();</div>
<div class="line">                        StartProcess(m_projectInfo.GetExePath(), txtStartArgTestFunc.Text + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text, m_projectInfo.targetDirPath);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunAllTestFuncs_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_FUNCS] == State.RUNNING)</div>
<div class="line">                {</div>
<div class="line">                    StopExecution();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (lstTestFuncs.Items.Count &gt; 0)</div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_FUNCS, lstTestFuncs.Items.Count);</div>
<div class="line">                        m_idxRunAllTestFuncs = 0;</div>
<div class="line">                        StartTestFunc(0);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnGoToSrcTestFunc_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (lstTestFuncs.SelectedItem == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;No test func selected!&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;GoTo src: selIndex=&quot;</span> + lstTestFuncs.SelectedIndex);</div>
<div class="line">                    m_mainEvents.OnOpenSourceFile(m_testFuncs[lstTestFuncs.SelectedIndex].fileFullPath,</div>
<div class="line">                        m_testFuncs[lstTestFuncs.SelectedIndex].lineNum);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnShowHideLog_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            m_logVisible = !m_logVisible;</div>
<div class="line">            RefreshDisplay();</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnClearEvents_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            lstEvents.Items.Clear();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnOpenProtocolFile_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            m_mainEvents.OnOpenProtocolFile();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRefreshAll_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            m_mainEvents.OnRefreshNow();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnCancelExecution_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            StopExecution();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxColVisibility_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            m_colVisibility = (ColVisibility)comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.IdxGroupsAndFuncs = comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            SetColVisibility();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxSortOrder_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            m_sortOrder = (SortOrder)comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.IdxSortOrder = comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            RefreshTestGroupList();</div>
<div class="line">            RefreshTestFuncList();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxLogVisibility_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            m_logVisible = (comboBox.SelectedIndex == 0);</div>
<div class="line">            Properties.Settings.Default.LogIsVisible = m_logVisible;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            RefreshDisplay();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxOutputLevel_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            Properties.Settings.Default.IdxOutputLevel = comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            m_mainEvents.OnSetOutputLevel(comboBox.SelectedIndex + 1);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxMemLeakCheck_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            <span class="keywordtype">bool</span> leakCheck = (comboBox.SelectedIndex == 0);</div>
<div class="line">            Properties.Settings.Default.CheckForMemoryLeaks = leakCheck;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">            m_executor.SetMemLeakCheck(leakCheck);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxMaxExecutionTime_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var comboBox = sender as ComboBox;</div>
<div class="line">            m_waitMode = (WaitMode)comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.IdxMaxWaitTime = comboBox.SelectedIndex;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> chkTestFuncsForSelTestGroup_CheckBoxChanged(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                RefreshTestFuncList();</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> chkUseDebugger_CheckBoxChanged(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                m_useDebugger = (bool)chkUseDebugger.IsChecked;</div>
<div class="line">                RefreshState();</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> lstTestGroups_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (lstTestGroups.SelectedItem == null)</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">            txtStartArgTestGroup.Text = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            m_selectedTestGroups.Clear();</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span> (MyListItem listItem <span class="keywordflow">in</span> lstTestGroups.SelectedItems)</div>
<div class="line">            {</div>
<div class="line">                txtStartArgTestGroup.Text += m_testGroups[listItem.idx].GetCmdString() + <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">                m_selectedTestGroups.Add(m_testGroups[listItem.idx].GetTestGroupHierarchyString());</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            RefreshTestFuncList();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> lstTestFuncs_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (lstTestFuncs.SelectedItem == null)</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">            txtStartArgTestFunc.Text = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span> (MyListItem listItem <span class="keywordflow">in</span> lstTestFuncs.SelectedItems)</div>
<div class="line">            {</div>
<div class="line">                txtStartArgTestFunc.Text += m_testFuncs[listItem.idx].GetCmdString() + <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoAboutCurrentProgress(RunMode in_runMode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> idx = (int)in_runMode;</div>
<div class="line">            <span class="keywordflow">if</span> (m_state[idx] == State.RUNNING)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> ((in_runMode == RunMode.TEST_APPS) &amp;&amp; (m_idxRunAllTestApps &gt;= 0))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot; &quot;</span> + System.IO.Path.GetFileNameWithoutExtension(m_currentTestApps[m_idxRunAllTestApps])</div>
<div class="line">                         + <span class="stringliteral">&quot; (&quot;</span> + (m_numExecutedTests[idx] + 1) + <span class="stringliteral">&quot; of &quot;</span> + m_totalNumTestsToExecute[idx] + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot; (&quot;</span> + (m_numExecutedTests[idx] + 1) + <span class="stringliteral">&quot; of &quot;</span> + m_totalNumTestsToExecute[idx] + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoAboutSucceededTest(RunMode in_runMode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> idx = (int)in_runMode;</div>
<div class="line">            <span class="keywordflow">if</span> (m_totalNumTestsToExecute[idx] &gt; 1)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot; (&quot;</span> + (m_numExecutedTests[idx]) + <span class="stringliteral">&quot; of &quot;</span> + m_totalNumTestsToExecute[idx] + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoAboutFailedTest(RunMode in_runMode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> idx = (int)in_runMode;</div>
<div class="line">            <span class="keywordflow">if</span> (m_totalNumTestsToExecute[idx] &gt; 1)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot; (&quot;</span> + (m_numFailedTests[idx]) + <span class="stringliteral">&quot; of &quot;</span> + m_numExecutedTests[idx] + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoAboutCurrentTest()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ((m_curRunMode == RunMode.TEST_APPS) &amp;&amp; (m_idxRunAllTestApps &gt;= 0))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> System.IO.Path.GetFileNameWithoutExtension(m_currentTestApps[m_idxRunAllTestApps]);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [dispatch test terminate msg]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> TestTerminated(<span class="keywordtype">bool</span> in_success, <span class="keywordtype">string</span> in_args, <span class="keywordtype">bool</span> in_memLeaksDetected, TimeSpan in_executionTime)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// For safe updating of status data process within GUI thread</span></div>
<div class="line">            this.Dispatcher.Invoke(<span class="keyword">new</span> Action(() =&gt;</div>
<div class="line">                TestTerminatedWithinGuiThread(in_success, <span class="stringliteral">&quot;&quot;</span>, in_args, in_memLeaksDetected, in_executionTime)));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> TestTerminatedWithinGuiThread(<span class="keywordtype">bool</span> in_success, <span class="keywordtype">string</span> infoAboutTest, <span class="keywordtype">string</span> in_args, <span class="keywordtype">bool</span> in_memLeaksDetected, TimeSpan in_executionTime)</div>
<div class="line">        {</div>
<div class="line">            m_executionTimer.Stop();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Display execution status</span></div>
<div class="line">            <span class="keywordtype">string</span> info = in_args;</div>
<div class="line">            <span class="keywordflow">if</span> (info == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">            {</div>
<div class="line">                info = <span class="stringliteral">&quot;&lt;no args set&gt;&quot;</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">string</span> durationStr;</div>
<div class="line">            <span class="keywordflow">if</span> (in_executionTime.TotalSeconds &lt; 1.0)</div>
<div class="line">            {</div>
<div class="line">                durationStr = <span class="stringliteral">&quot;&lt;1s &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">double</span> totalNumMinutes = in_executionTime.TotalSeconds / 60.0;</div>
<div class="line">                durationStr = totalNumMinutes.ToString(<span class="stringliteral">&quot;F1&quot;</span>)+ <span class="stringliteral">&quot;m &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//int totalNumSeconds = Convert.ToInt32(Math.Round(in_executionTime.TotalSeconds));</span></div>
<div class="line">            <span class="comment">//int totalNumMinutes = totalNumSeconds / 60;</span></div>
<div class="line">            <span class="comment">//int numSeconds = totalNumSeconds % 60;</span></div>
<div class="line">            <span class="comment">//int numSecondsAsDecimalMinute = numSeconds / 6;</span></div>
<div class="line">            <span class="comment">//string durationStr = totalNumMinutes + &quot;,&quot; + numSecondsAsDecimalMinute + &quot;m &quot;;</span></div>
<div class="line"></div>
<div class="line">            WriteLine(1, (!in_success ? <span class="stringliteral">&quot;FAILED: &quot;</span> : (in_memLeaksDetected ? <span class="stringliteral">&quot;FAILED (MEM_LEAKS): &quot;</span> : <span class="stringliteral">&quot;OK: &quot;</span>))</div>
<div class="line">                + durationStr + GetInfoAboutCurrentTest() + <span class="stringliteral">&quot; &quot;</span> + info);</div>
<div class="line">            <span class="keywordtype">bool</span> failure = !in_success || in_memLeaksDetected;</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">int</span> idx = (int)m_curRunMode;</div>
<div class="line">            ++m_numExecutedTests[idx];</div>
<div class="line">            <span class="keywordflow">if</span> (failure)</div>
<div class="line">            {</div>
<div class="line">                ++m_numFailedTests[idx];</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span> testSucceededUpToNow = (m_numFailedTests[idx] == 0);</div>
<div class="line">            <span class="comment">// Safe update of state variables and refresh</span></div>
<div class="line">            <span class="comment">// of GUI controls within GUI thread</span></div>
<div class="line">            SetState(testSucceededUpToNow);<span class="comment"></span></div>
<div class="line"><span class="comment">            /// ...</span></div>
<div class="line"><span class="comment">            /// [dispatch test terminate msg]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">            <span class="keywordflow">if</span> (!m_stoppedByUser)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_idxRunAllTestGroups &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    ++m_idxRunAllTestGroups;</div>
<div class="line">                    <span class="keywordflow">if</span> (m_idxRunAllTestGroups &gt;= lstTestGroups.Items.Count)</div>
<div class="line">                    {</div>
<div class="line">                        m_idxRunAllTestGroups = -1;</div>
<div class="line">                        CheckForFinalAction(RunMode.TEST_GROUPS);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="comment">// start next test</span></div>
<div class="line">                    {</div>
<div class="line">                        StartTestGroup(m_idxRunAllTestGroups);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_idxRunAllTestFuncs &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    ++m_idxRunAllTestFuncs;</div>
<div class="line">                    <span class="keywordflow">if</span> (m_idxRunAllTestFuncs &gt;= lstTestFuncs.Items.Count)</div>
<div class="line">                    {</div>
<div class="line">                        m_idxRunAllTestFuncs = -1;</div>
<div class="line">                        CheckForFinalAction(RunMode.TEST_FUNCS);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="comment">// start next test</span></div>
<div class="line">                    {</div>
<div class="line">                        StartTestFunc(m_idxRunAllTestFuncs);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_idxRunAllTestApps &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    ++m_idxRunAllTestApps;</div>
<div class="line">                    <span class="keywordflow">if</span> (m_idxRunAllTestApps &gt;= m_currentTestApps.Count)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// last test app has terminated</span></div>
<div class="line">                        m_idxRunAllTestApps = -1;</div>
<div class="line">                        CheckForFinalAction(RunMode.TEST_APPS);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="comment">// start next test</span></div>
<div class="line">                    {</div>
<div class="line">                        StartTestApp(m_idxRunAllTestApps);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    CheckForFinalAction(RunMode.TEST_STARTUP_PROJECT);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartTestGroup(<span class="keywordtype">int</span> in_idx)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_testGroups[in_idx].GetDisplayString() == <span class="stringliteral">&quot;&lt;default&gt;&quot;</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Simulate successful execution</span></div>
<div class="line">                TestTerminatedWithinGuiThread(<span class="keyword">true</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&lt;execution skipped&gt;&quot;</span>, <span class="keyword">false</span>, <span class="keyword">new</span> TimeSpan(0));</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            m_state[(int)m_curRunMode] = State.RUNNING;</div>
<div class="line">            RefreshState();</div>
<div class="line">            StartProcess(m_projectInfo.GetExePath(), m_testGroups[in_idx].GetCmdString() + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text, m_projectInfo.targetDirPath);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartTestFunc(<span class="keywordtype">int</span> in_idx)</div>
<div class="line">        {</div>
<div class="line">            m_state[(int)m_curRunMode] = State.RUNNING;</div>
<div class="line">            RefreshState();</div>
<div class="line">            StartProcess(m_projectInfo.GetExePath(), m_testFuncs[in_idx].GetCmdString() + <span class="stringliteral">&quot; &quot;</span> + cbxDefaultArgs.Text, m_projectInfo.targetDirPath);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartTestApp(<span class="keywordtype">int</span> in_idx)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">string</span> exePathWithOptionalArgs = m_currentTestApps[in_idx];</div>
<div class="line">            <span class="keywordtype">string</span> exeToStart = exePathWithOptionalArgs;</div>
<div class="line">            <span class="keywordtype">string</span> args = cbxDefaultArgs.Text;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Check for optional cmd args after executable</span></div>
<div class="line">            <span class="keywordtype">string</span> tmpExeToStart = exeToStart.ToLower();</div>
<div class="line">            <span class="keywordtype">int</span> posStartExtension = tmpExeToStart.LastIndexOf(<span class="stringliteral">&quot;.exe&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (posStartExtension &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">int</span> posStartArgs = posStartExtension + 5;</div>
<div class="line">                <span class="keywordflow">if</span> (posStartArgs &lt; exeToStart.Length)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">string</span> specificArgs = exePathWithOptionalArgs.Substring(posStartArgs);</div>
<div class="line">                    <span class="keywordflow">if</span> (specificArgs.Length &gt; 0)</div>
<div class="line">                    {</div>
<div class="line">                        args = specificArgs + <span class="stringliteral">&quot; &quot;</span> + args;</div>
<div class="line">                        exeToStart = exePathWithOptionalArgs.Substring(0, posStartArgs - 1);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">            }</div>
<div class="line">            m_state[(int)m_curRunMode] = State.RUNNING;</div>
<div class="line">            RefreshState();</div>
<div class="line">            StartProcess(exeToStart, args, System.IO.Path.GetDirectoryName(exeToStart));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SetState(<span class="keywordtype">bool</span> in_success)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)m_curRunMode] == State.RUNNING)</div>
<div class="line">            {</div>
<div class="line">                m_state[(int)m_curRunMode] = (in_success ? State.SUCCEEDED : State.FAILED);</div>
<div class="line">            }</div>
<div class="line">            RefreshState();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshState(RunMode in_runMode, TextBlock tb, <span class="keywordtype">string</span> info, <span class="keywordtype">bool</span> setText = <span class="keyword">true</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_state[(<span class="keywordtype">int</span>)in_runMode])</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> State.IDLE:</div>
<div class="line">                    tb.Background = m_originalBrushTextBlock;</div>
<div class="line">                    <span class="comment">//tb.Background = System.Windows.Media.Brushes.LightGray;</span></div>
<div class="line">                    tb.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                    <span class="keywordflow">if</span> (setText)</div>
<div class="line">                    {</div>
<div class="line">                        tb.Text = info;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> State.RUNNING:</div>
<div class="line">                    tb.Background = System.Windows.Media.Brushes.Orange;</div>
<div class="line">                    tb.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                    <span class="keywordflow">if</span> (setText)</div>
<div class="line">                    {</div>
<div class="line">                        tb.Text = <span class="stringliteral">&quot;Running&quot;</span> + GetInfoAboutCurrentProgress(in_runMode);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> State.SUCCEEDED:</div>
<div class="line">                    tb.Background = System.Windows.Media.Brushes.LightGreen;</div>
<div class="line">                    tb.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                    <span class="keywordflow">if</span> (setText)</div>
<div class="line">                    {</div>
<div class="line">                        tb.Text = <span class="stringliteral">&quot;OK&quot;</span> + GetInfoAboutSucceededTest(in_runMode); ;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> State.FAILED:</div>
<div class="line">                    tb.Background = System.Windows.Media.Brushes.Red;</div>
<div class="line">                    tb.Foreground = System.Windows.Media.Brushes.White;</div>
<div class="line">                    <span class="keywordflow">if</span> (setText)</div>
<div class="line">                    {</div>
<div class="line">                        tb.Text = <span class="stringliteral">&quot;FAILED&quot;</span> + GetInfoAboutFailedTest(in_runMode);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshButtonState(State state, Button btn)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_useDebugger)</div>
<div class="line">            {</div>
<div class="line">                btn.Background = m_originalBrushButton;</div>
<div class="line">                btn.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">switch</span> (state)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> State.IDLE:</div>
<div class="line">                        btn.Background = m_originalBrushButton;</div>
<div class="line">                        btn.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> State.RUNNING:</div>
<div class="line">                        btn.Background = System.Windows.Media.Brushes.Orange;</div>
<div class="line">                        btn.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> State.SUCCEEDED:</div>
<div class="line">                        btn.Background = System.Windows.Media.Brushes.LightGreen;</div>
<div class="line">                        btn.Foreground = System.Windows.Media.Brushes.Black;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> State.FAILED:</div>
<div class="line">                        btn.Background = System.Windows.Media.Brushes.Red;</div>
<div class="line">                        btn.Foreground = System.Windows.Media.Brushes.White;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshState()</div>
<div class="line">        {</div>
<div class="line">            RefreshState(RunMode.TEST_GROUPS, txtInfoStarArgTestGroup, GetInfoStartArgTestGroup());</div>
<div class="line">            RefreshState(RunMode.TEST_FUNCS, txtInfoStarArgTestFunc, GetInfoStartArgTestFunc());</div>
<div class="line">            RefreshState(RunMode.TEST_STARTUP_PROJECT, txtInfo, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line">            RefreshState(RunMode.TEST_APPS, txtInfoTestApps, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">            RefreshButtons();</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshButtons()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_useDebugger)</div>
<div class="line">            {</div>
<div class="line">                btnRunTestAll.IsEnabled = <span class="keyword">true</span>;</div>
<div class="line">                btnRunSelectedTestGroup.IsEnabled = <span class="keyword">true</span>;</div>
<div class="line">                btnRunSelectedTestFunc.IsEnabled = <span class="keyword">true</span>;</div>
<div class="line">                btnRunAllTestGroups.IsEnabled = <span class="keyword">false</span>;</div>
<div class="line">                btnRunAllTestFuncs.IsEnabled = <span class="keyword">false</span>;</div>
<div class="line">                btnRunAllTestApps.IsEnabled = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">                btnRunTestAll.Content = <span class="stringliteral">&quot;Debug&quot;</span>;</div>
<div class="line">                btnRunSelectedTestGroup.Content = <span class="stringliteral">&quot;Debug&quot;</span>;</div>
<div class="line">                btnRunSelectedTestFunc.Content = <span class="stringliteral">&quot;Debug&quot;</span>;</div>
<div class="line">                btnRunAllTestGroups.Content = <span class="stringliteral">&quot;Run each&quot;</span>;</div>
<div class="line">                btnRunAllTestFuncs.Content = <span class="stringliteral">&quot;Run each&quot;</span>;</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span> running = (m_state[(int)RunMode.TEST_STARTUP_PROJECT] == State.RUNNING)</div>
<div class="line">                || (m_state[(int)RunMode.TEST_GROUPS] == State.RUNNING)</div>
<div class="line">                || (m_state[(int)RunMode.TEST_FUNCS] == State.RUNNING)</div>
<div class="line">                || (m_state[(int)RunMode.TEST_APPS] == State.RUNNING);</div>
<div class="line"></div>
<div class="line">            chkUseDebugger.IsEnabled = !running;</div>
<div class="line"></div>
<div class="line">            btnRunTestAll.IsEnabled = !running || (m_state[(int)RunMode.TEST_STARTUP_PROJECT] == State.RUNNING);</div>
<div class="line">            btnRunSelectedTestGroup.IsEnabled = !running || ((m_state[(int)RunMode.TEST_GROUPS] == State.RUNNING) &amp;&amp; (m_idxRunAllTestGroups == -1));</div>
<div class="line">            btnRunAllTestGroups.IsEnabled = !running || ((m_state[(int)RunMode.TEST_GROUPS] == State.RUNNING) &amp;&amp; (m_idxRunAllTestGroups &gt;= 0));</div>
<div class="line">            btnRunSelectedTestFunc.IsEnabled = !running || ((m_state[(int)RunMode.TEST_FUNCS] == State.RUNNING) &amp;&amp; (m_idxRunAllTestFuncs == -1));</div>
<div class="line">            btnRunAllTestFuncs.IsEnabled = !running || ((m_state[(int)RunMode.TEST_FUNCS] == State.RUNNING) &amp;&amp; (m_idxRunAllTestFuncs &gt;= 0));</div>
<div class="line">            btnOpenProtocolFile.IsEnabled = !running;</div>
<div class="line">            btnRefreshAll.IsEnabled = !running;</div>
<div class="line"></div>
<div class="line">            btnRunTestAll.Content = ((btnRunTestAll.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop&quot;</span> : <span class="stringliteral">&quot;Run&quot;</span>);</div>
<div class="line">            btnRunSelectedTestGroup.Content = ((btnRunSelectedTestGroup.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop test&quot;</span> : <span class="stringliteral">&quot;Run selected&quot;</span>);</div>
<div class="line">            btnRunAllTestGroups.Content = ((btnRunAllTestGroups.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop test&quot;</span> : <span class="stringliteral">&quot;Run each&quot;</span>);</div>
<div class="line">            btnRunSelectedTestFunc.Content = ((btnRunSelectedTestFunc.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop test&quot;</span> : <span class="stringliteral">&quot;Run selected&quot;</span>);</div>
<div class="line">            btnRunAllTestFuncs.Content = ((btnRunAllTestFuncs.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop test&quot;</span> : <span class="stringliteral">&quot;Run each&quot;</span>);</div>
<div class="line"></div>
<div class="line">            btnRunAllTestApps.IsEnabled = !running || (m_state[(int)RunMode.TEST_APPS] == State.RUNNING);</div>
<div class="line">            btnRunAllTestApps.Content = ((btnRunAllTestApps.IsEnabled &amp;&amp; running) ? <span class="stringliteral">&quot;Stop&quot;</span> : <span class="stringliteral">&quot;Run all&quot;</span>);</div>
<div class="line"></div>
<div class="line">            btnMoreOptions.Content = (m_optionsVisible ? <span class="stringliteral">&quot;Hide&quot;</span> : <span class="stringliteral">&quot;...&quot;</span>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//RefreshButtonState(m_stateTestAll, btnRunTestAll);</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SetRowVisibility()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_optionsVisible)</div>
<div class="line">            {</div>
<div class="line">                mainRowOptions.Height = <span class="keyword">new</span> GridLength(56);</div>
<div class="line">                mainRowDefaultArgs.Height = <span class="keyword">new</span> GridLength(30);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                mainRowOptions.Height = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">                mainRowDefaultArgs.Height = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (m_logVisible)</div>
<div class="line">            {</div>
<div class="line">                mainRowLog.Height = <span class="keyword">new</span> GridLength(5, GridUnitType.Star);</div>
<div class="line">                mainRowLogButton.Height = <span class="keyword">new</span> GridLength(30);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                mainRowLog.Height = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">                mainRowLogButton.Height = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SetColVisibility()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_colVisibility)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> ColVisibility.BOTH:</div>
<div class="line">                    mainColGroups.Width = <span class="keyword">new</span> GridLength(1, GridUnitType.Star);</div>
<div class="line">                    mainColFuncs.Width = <span class="keyword">new</span> GridLength(1, GridUnitType.Star);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> ColVisibility.LEFT:</div>
<div class="line">                    mainColGroups.Width = <span class="keyword">new</span> GridLength(1, GridUnitType.Star);</div>
<div class="line">                    mainColFuncs.Width = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> ColVisibility.RIGHT:</div>
<div class="line">                    mainColGroups.Width = <span class="keyword">new</span> GridLength(0);</div>
<div class="line">                    mainColFuncs.Width = <span class="keyword">new</span> GridLength(1, GridUnitType.Star);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">bool</span> TestIsRunning()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_state[i] == State.RUNNING)</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> TriggerDelayedRefresh()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Redirect to main GUI thread</span></div>
<div class="line">            WriteLine(2, <span class="stringliteral">&quot;TriggerDelayedRefresh: passing to gui thread...&quot;</span>);</div>
<div class="line">            lstEvents.Dispatcher.Invoke(<span class="keyword">new</span> Action(() =&gt; TriggerDelayedRefreshFromGuiThread()));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> TriggerDelayedRefreshFromGuiThread()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_refreshTimerIsActive)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;TriggerDelayedRefreshFromGuiThread: timer already active,call is ignored&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            m_refreshTimerIsActive = <span class="keyword">true</span>;</div>
<div class="line">            m_refreshTimer.Tick += <span class="keyword">new</span> EventHandler(RefreshTimer_Elapsed);</div>
<div class="line">            m_refreshTimer.Interval = <span class="keyword">new</span> TimeSpan(0, 0, 1);</div>
<div class="line">            m_refreshTimer.Start();</div>
<div class="line">            WriteLine(2, <span class="stringliteral">&quot;TriggerDelayedRefreshFromGuiThread: new timer started&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshTimer_Elapsed(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!m_refreshTimerIsActive)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;RefreshTimer_Elapsed: timer already stopped, ignore timer event!&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            WriteLine(2, <span class="stringliteral">&quot;RefreshTimer_Elapsed: timer will be stopped, refresh is executed&quot;</span>);</div>
<div class="line">            m_refreshTimerIsActive = <span class="keyword">false</span>;</div>
<div class="line">            m_refreshTimer.Stop();</div>
<div class="line">            m_mainEvents.OnRefreshNow();</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [threading sync gui thread]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> AddInfoToEventList(<span class="keywordtype">string</span> info)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Redirect to main GUI thread</span></div>
<div class="line">            lstEvents.Dispatcher.Invoke(<span class="keyword">new</span> Action(() =&gt; AddInfoToEventListFromGuiThread(info)));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddInfoToEventListFromGuiThread(<span class="keywordtype">string</span> info)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// here we are sure to be within GUI thread and we can</span></div>
<div class="line">            <span class="comment">// safely access the list box</span></div>
<div class="line">            lstEvents.Items.Add(info);<span class="comment"></span></div>
<div class="line"><span class="comment">            /// ...</span></div>
<div class="line"><span class="comment">            /// [threading sync gui thread]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">            <span class="comment">// Ensure last added item is visible</span></div>
<div class="line">            System.Windows.Automation.Peers.ListBoxAutomationPeer svAutomation = (System.Windows.Automation.Peers.ListBoxAutomationPeer)</div>
<div class="line">                System.Windows.Automation.Peers.ScrollViewerAutomationPeer.CreatePeerForElement(lstEvents);</div>
<div class="line"></div>
<div class="line">            System.Windows.Automation.Provider.IScrollProvider scrollInterface = (System.Windows.Automation.Provider.IScrollProvider)svAutomation.GetPattern(System.Windows.Automation.Peers.PatternInterface.Scroll);</div>
<div class="line">            System.Windows.Automation.ScrollAmount scrollVertical = System.Windows.Automation.ScrollAmount.LargeIncrement;</div>
<div class="line">            System.Windows.Automation.ScrollAmount scrollHorizontal = System.Windows.Automation.ScrollAmount.NoAmount;</div>
<div class="line">            <span class="comment">//If the vertical scroller is not available, the operation cannot be performed, which will raise an exception. </span></div>
<div class="line">            <span class="keywordflow">if</span> (scrollInterface == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (scrollInterface.VerticallyScrollable)</div>
<div class="line">                scrollInterface.Scroll(scrollHorizontal, scrollVertical);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//lstEvents..TopIndex = lstEvents.Items.Count - 1;</span></div>
<div class="line">            <span class="comment">//lstEvents.SelectedIndex = -1;</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">internal</span> <span class="keywordtype">void</span> SetTestInfo(ProjectInfo in_projectInfo)</div>
<div class="line">        {</div>
<div class="line">            m_projectInfo = in_projectInfo;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line">            {</div>
<div class="line">                m_state[i] = State.IDLE;</div>
<div class="line">                m_numFailedTests[i] = 0;</div>
<div class="line">                m_numExecutedTests[i] = 0;</div>
<div class="line">                m_totalNumTestsToExecute[i] = 0;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (m_projectInfo != null)</div>
<div class="line">            {</div>
<div class="line">                txtInfo.Text = m_projectInfo.project + <span class="stringliteral">&quot; - &quot;</span> + m_projectInfo.config;</div>
<div class="line">                RefreshTestGroupList();</div>
<div class="line">                RefreshTestFuncList();</div>
<div class="line">            }</div>
<div class="line">            RefreshDisplay();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoStartArgTestGroup()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_projectInfo.appType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> AppType.BOOST:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select test suite / edit cmd&quot;</span>;</div>
<div class="line">                <span class="keywordflow">case</span> AppType.TTB:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select test file / edit cmd&quot;</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;--&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetInfoStartArgTestFunc()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_projectInfo.appType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> AppType.BOOST:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select single test case / edit cmd&quot;</span>;</div>
<div class="line">                <span class="keywordflow">case</span> AppType.TTB:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select single test func / edit cmd&quot;</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;--&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshDisplay()</div>
<div class="line">        {</div>
<div class="line">            RefreshDisplayText();</div>
<div class="line">            RefreshState();</div>
<div class="line">            SetColVisibility();</div>
<div class="line">            SetRowVisibility();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshDisplayText()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_projectInfo.appType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> AppType.BOOST:</div>
<div class="line">                    txtInfoTestGroups.Text = <span class="stringliteral">&quot;BOOST test suites&quot;</span>;</div>
<div class="line">                    txtInfoTestFuncs.Text = <span class="stringliteral">&quot;BOOST test cases&quot;</span>;</div>
<div class="line">                    chkTestFuncsForSelTestGroup.Content = <span class="stringliteral">&quot;within suite&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> AppType.TTB:</div>
<div class="line">                    txtInfoTestGroups.Text = <span class="stringliteral">&quot;TTB test files&quot;</span>;</div>
<div class="line">                    txtInfoTestFuncs.Text = <span class="stringliteral">&quot;TTB test functions&quot;</span>;</div>
<div class="line">                    chkTestFuncsForSelTestGroup.Content = <span class="stringliteral">&quot;within file&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    txtInfoTestGroups.Text = <span class="stringliteral">&quot;--&quot;</span>;</div>
<div class="line">                    txtInfoTestFuncs.Text = <span class="stringliteral">&quot;--&quot;</span>;</div>
<div class="line">                    chkTestFuncsForSelTestGroup.Content = <span class="stringliteral">&quot;--&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshTestGroupList()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> lastSelectedIndex = lstTestGroups.SelectedIndex;</div>
<div class="line"></div>
<div class="line">            lstTestGroups.Items.Clear();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Copy test groups to local collection which may be sorted</span></div>
<div class="line">            m_testGroups = <span class="keyword">new</span> System.Collections.Generic.List&lt;TestGroupEntry&gt;(m_projectInfo.testGroups);</div>
<div class="line">            m_selectedTestGroups = <span class="keyword">new</span> HashSet&lt;string&gt;();</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">switch</span> (m_sortOrder)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.AS_READ_FROM_FILE:</div>
<div class="line">                    <span class="comment">// do not change sort order</span></div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.REVERSE_READ:</div>
<div class="line">                    {</div>
<div class="line">                        m_testGroups.Reverse();</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.ALPHA:</div>
<div class="line">                    {</div>
<div class="line">                        m_testGroups.Sort((x, y) =&gt; x.GetDisplayString().CompareTo(y.GetDisplayString()));</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.REVERSE_ALPHA:</div>
<div class="line">                    {</div>
<div class="line">                        m_testGroups.Sort((x, y) =&gt; y.GetDisplayString().CompareTo(x.GetDisplayString()));</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Copy sorted entries to listbox</span></div>
<div class="line">            <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span> (var testGroupEntry <span class="keywordflow">in</span> m_testGroups)</div>
<div class="line">            {</div>
<div class="line">                MyListItem entry = <span class="keyword">new</span> MyListItem(idx, testGroupEntry.GetDisplayString());</div>
<div class="line">                lstTestGroups.Items.Add(entry);</div>
<div class="line">                ++idx;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ((lstTestGroups.Items.Count &gt; 0) &amp;&amp; (lastSelectedIndex &gt;= 0))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">int</span> selIndex = (lastSelectedIndex &lt; lstTestGroups.Items.Count) ? lastSelectedIndex : lstTestGroups.Items.Count - 1;</div>
<div class="line">                {</div>
<div class="line">                    lstTestGroups.SelectedIndex = selIndex;</div>
<div class="line">                    m_selectedTestGroups.Clear();</div>
<div class="line">                    <span class="keywordflow">if</span> (selIndex &gt;= 0)</div>
<div class="line">                    {</div>
<div class="line">                        m_selectedTestGroups.Add(m_testGroups[selIndex].GetTestGroupHierarchyString());</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RefreshTestFuncList()</div>
<div class="line">        {</div>
<div class="line">            lstTestFuncs.Items.Clear();</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">bool</span> showOnlyFuncsWithinGroup = (bool)chkTestFuncsForSelTestGroup.IsChecked;</div>
<div class="line">            if (showOnlyFuncsWithinGroup)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (lstTestGroups.SelectedItem == null)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (lstTestGroups.Items.Count == 0)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// no test groups available</span></div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span> (lstTestGroups.Items.Count &gt; 0)</div>
<div class="line">                    {</div>
<div class="line">                        lstTestGroups.SelectedIndex = 0;</div>
<div class="line">                        <span class="keywordflow">if</span> (lstTestGroups.SelectedItem == null)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="comment">// nothing selected</span></div>
<div class="line">                            <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Create local collection of test funcs which may be sorted</span></div>
<div class="line">            m_testFuncs = <span class="keyword">new</span> System.Collections.Generic.List&lt;TestFuncEntry&gt;();</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span> (var testFuncEntry <span class="keywordflow">in</span> m_projectInfo.testFuncs)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (showOnlyFuncsWithinGroup)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (m_selectedTestGroups.Contains(testFuncEntry.GetTestGroupHierarchyString()))</div>
<div class="line">                    {</div>
<div class="line">                        m_testFuncs.Add(testFuncEntry);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// show all test funcs</span></div>
<div class="line">                {</div>
<div class="line">                    m_testFuncs.Add(testFuncEntry);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">switch</span> (m_sortOrder)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.AS_READ_FROM_FILE:</div>
<div class="line">                    <span class="comment">// do not change sort order</span></div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.REVERSE_READ:</div>
<div class="line">                    {</div>
<div class="line">                        m_testFuncs.Reverse();</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.ALPHA:</div>
<div class="line">                    {</div>
<div class="line">                        m_testFuncs.Sort((x, y) =&gt; x.GetDisplayString().CompareTo(y.GetDisplayString()));</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> SortOrder.REVERSE_ALPHA:</div>
<div class="line">                    {</div>
<div class="line">                        m_testFuncs.Sort((x, y) =&gt; y.GetDisplayString().CompareTo(x.GetDisplayString()));</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span> (var testFuncEntry <span class="keywordflow">in</span> m_testFuncs)</div>
<div class="line">            {</div>
<div class="line">                MyListItem entry = <span class="keyword">new</span> MyListItem(idx, testFuncEntry.GetDisplayString());</div>
<div class="line">                lstTestFuncs.Items.Add(entry);</div>
<div class="line">                ++idx;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StopExecution()</div>
<div class="line">        {</div>
<div class="line">            m_stoppedByUser = <span class="keyword">true</span>;</div>
<div class="line">            m_executor.KillRunningProcess();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteLine(<span class="keywordtype">int</span> in_outputLevel, String in_info)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_evenReceiver != null)</div>
<div class="line">            {</div>
<div class="line">                m_evenReceiver.WriteLine(in_outputLevel, in_info);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxDefaultArgs_TextChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;cbxDefaultArgs_TextChanged: Storing new args=&quot;</span> + cbxDefaultArgs.Text);</div>
<div class="line">            Properties.Settings.Default.GeneralCmdLineArgs = cbxDefaultArgs.Text;</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxDescTestApps_SelectionChanged(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (cbxDescTestApps.SelectedIndex &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">                m_idxCurrentTestApps = cbxDescTestApps.SelectedIndex;</div>
<div class="line">                Properties.Settings.Default.IdxCurrentTestApps = m_idxCurrentTestApps;</div>
<div class="line">                Properties.Settings.Default.Save();</div>
<div class="line">                m_state[(int)RunMode.TEST_APPS] = State.IDLE;</div>
<div class="line">                LoadCurrentTestApps();</div>
<div class="line">                RefreshState();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> LoadCurrentTestApps()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_idxCurrentTestApps)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> 0:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps1;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 1:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps2;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 2:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps3;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 3:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps4;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 4:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps5;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 5:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps6;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 6:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps7;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    txtTestApps.Text = Properties.Settings.Default.TestApps8;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SaveCurrentTestApps()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_idxCurrentTestApps)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> 0:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps1 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps1 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 1:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps2 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps2 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 2:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps3 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps3 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 3:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps4 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps4 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 4:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps5 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps5 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 5:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps6 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps6 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 6:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps7 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps7 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    Properties.Settings.Default.DescTestApps8 = cbxDescTestApps.Text;</div>
<div class="line">                    Properties.Settings.Default.TestApps8 = txtTestApps.Text;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            Properties.Settings.Default.Save();</div>
<div class="line"></div>
<div class="line">            m_dataDescTestApps[m_idxCurrentTestApps] = cbxDescTestApps.Text;</div>
<div class="line">            cbxDescTestApps.ItemsSource = null;</div>
<div class="line">            cbxDescTestApps.ItemsSource = m_dataDescTestApps;</div>
<div class="line">            cbxDescTestApps.SelectedIndex = m_idxCurrentTestApps;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnSaveTestApps_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;Save test apps&quot;</span>);</div>
<div class="line">            SaveCurrentTestApps();</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnReloadTestApps_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;Reload test apps&quot;</span>);</div>
<div class="line">            LoadCurrentTestApps();</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnClearTestApps_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            txtTestApps.Text = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnRunAllTestApps_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;Run all test apps&quot;</span>);</div>
<div class="line">            <span class="keywordtype">string</span> txt = txtTestApps.Text;</div>
<div class="line">            <span class="keywordtype">string</span>[] tmpTestApps = txt.Split(<span class="keyword">new</span> Char[] { <span class="charliteral">&#39;\n&#39;</span>, <span class="charliteral">&#39;\r&#39;</span> }, StringSplitOptions.RemoveEmptyEntries);</div>
<div class="line">            m_currentTestApps.Clear();</div>
<div class="line">            <span class="keywordflow">foreach</span> (var app <span class="keywordflow">in</span> tmpTestApps)</div>
<div class="line">            {</div>
<div class="line">                app.Trim();</div>
<div class="line">                <span class="keywordflow">if</span> (app.IndexOf(<span class="stringliteral">&quot;//&quot;</span>) != 0) <span class="comment">// skip comment lines</span></div>
<div class="line">                {</div>
<div class="line">                    m_currentTestApps.Add(app);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_state[(<span class="keywordtype">int</span>)RunMode.TEST_APPS] == State.RUNNING)</div>
<div class="line">                {</div>
<div class="line">                    StopExecution();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (m_currentTestApps.Count &gt; 0)</div>
<div class="line">                    {</div>
<div class="line">                        InitForTestExecution(RunMode.TEST_APPS, m_currentTestApps.Count);</div>
<div class="line">                        m_idxRunAllTestApps = 0;</div>
<div class="line">                        StartTestApp(0);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetExportInfo(<span class="keywordtype">bool</span> in_withTimeStamp)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">string</span> info = <span class="stringliteral">&quot;Exported from TestExecWin - &quot;</span> + txtInfo.Text;</div>
<div class="line">            <span class="keywordflow">if</span> (in_withTimeStamp)</div>
<div class="line">            {</div>
<div class="line">                var now = DateTime.Now;</div>
<div class="line">                info += <span class="stringliteral">&quot; - &quot;</span> + now.ToShortDateString() + <span class="stringliteral">&quot; &quot;</span> + now.ToLongTimeString();</div>
<div class="line">                info = <span class="stringliteral">&quot;// &quot;</span> + info + <span class="stringliteral">&quot;\n// Source path: &quot;</span> + m_projectInfo.sourceDirPath + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> info;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">string</span> GetListBoxItemsAsText(System.Windows.Controls.ListBox in_listBox)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">string</span> contents = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            <span class="keywordflow">foreach</span> (var i <span class="keywordflow">in</span> in_listBox.Items)</div>
<div class="line">            {</div>
<div class="line">                contents += i.ToString() + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> contents;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnExportLog_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                System.Windows.Forms.SaveFileDialog saveFileDialog = <span class="keyword">new</span> System.Windows.Forms.SaveFileDialog();</div>
<div class="line">                saveFileDialog.Filter = <span class="stringliteral">&quot;txt files (*.txt)|*.txt|All files (*.*)|*.*&quot;</span>;</div>
<div class="line">                saveFileDialog.FileName = GetExportInfo(<span class="keyword">false</span>);</div>
<div class="line">                saveFileDialog.RestoreDirectory = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (saveFileDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)</div>
<div class="line">                {</div>
<div class="line">                    System.IO.File.WriteAllText(saveFileDialog.FileName,</div>
<div class="line">                        GetExportInfo(<span class="keyword">true</span>) + <span class="stringliteral">&quot;\n&quot;</span> + GetListBoxItemsAsText(lstEvents));</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> btnCopyLog_Click(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                System.Windows.Forms.Clipboard.SetText(GetExportInfo(<span class="keyword">true</span>) + <span class="stringliteral">&quot;\n&quot;</span> + GetListBoxItemsAsText(lstEvents));</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;Copied to clipboard, ready for pasting!&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ExportTestAppsToFile()</div>
<div class="line">        {</div>
<div class="line">            System.Windows.Forms.SaveFileDialog saveFileDialog = <span class="keyword">new</span> System.Windows.Forms.SaveFileDialog();</div>
<div class="line">            saveFileDialog.Filter = <span class="stringliteral">&quot;txt files (*.txt)|*.txt|All files (*.*)|*.*&quot;</span>;</div>
<div class="line">            saveFileDialog.FileName = cbxDescTestApps.Text;</div>
<div class="line">            saveFileDialog.RestoreDirectory = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (saveFileDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)</div>
<div class="line">            {</div>
<div class="line">                System.IO.File.WriteAllText(saveFileDialog.FileName, txtTestApps.Text);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportTestAppsFromFile()</div>
<div class="line">        {</div>
<div class="line">            System.Windows.Forms.OpenFileDialog openFileDialog = <span class="keyword">new</span> System.Windows.Forms.OpenFileDialog();</div>
<div class="line">            openFileDialog.Filter = <span class="stringliteral">&quot;txt files (*.txt)|*.txt|All files (*.*)|*.*&quot;</span>;</div>
<div class="line">            openFileDialog.RestoreDirectory = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (openFileDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">string</span> readText = System.IO.File.ReadAllText(openFileDialog.FileName);</div>
<div class="line">                txtTestApps.Text += <span class="stringliteral">&quot;\n// Imported from file &quot;</span> + openFileDialog.FileName + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">                txtTestApps.Text += readText;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportTestAppsFromSolution()</div>
<div class="line">        {</div>
<div class="line">            txtTestApps.Text += <span class="stringliteral">&quot;\n// Imported executables from current solution &quot;</span> + System.IO.Path.GetFileName(m_projectInfo.solutionFullPath) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            <span class="keywordtype">string</span> foundExePaths = m_mainEvents.OnGetExecutablesFromCurrentSolution();</div>
<div class="line">            txtTestApps.Text += foundExePaths;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportTestAppsFromCurrentTestGroups()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">string</span> executablesWithStartArgs = <span class="stringliteral">&quot;\n// Imported test suites from &quot;</span> + m_projectInfo.project + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m_testGroups.Count; ++i)</div>
<div class="line">            {</div>
<div class="line">                executablesWithStartArgs += m_projectInfo.GetExePath() + <span class="stringliteral">&quot; &quot;</span> + m_testGroups[i].GetCmdString() + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            txtTestApps.Text += executablesWithStartArgs;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportTestAppsFromCurrentTestFuncs()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">string</span> executablesWithStartArgs = <span class="stringliteral">&quot;\n// Imported visible test cases from &quot;</span> + m_projectInfo.project + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m_testFuncs.Count; ++i)</div>
<div class="line">            {</div>
<div class="line">                executablesWithStartArgs += m_projectInfo.GetExePath() + <span class="stringliteral">&quot; &quot;</span> + m_testFuncs[i].GetCmdString() + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            txtTestApps.Text += executablesWithStartArgs;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> cbxExportImportTestApps_SelectionChangeCommitted(<span class="keywordtype">object</span> sender, SelectionChangedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">switch</span> (cbxExportImportTestApps.SelectedIndex)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> (<span class="keywordtype">int</span>)ExpImpMode.EXPORT_TO_FILE:</div>
<div class="line">                        ExportTestAppsToFile();</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> (<span class="keywordtype">int</span>)ExpImpMode.IMPPORT_FROM_FILE:</div>
<div class="line">                        ImportTestAppsFromFile();</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> (<span class="keywordtype">int</span>)ExpImpMode.IMPORT_FROM_SOLUTION:</div>
<div class="line">                        ImportTestAppsFromSolution();</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> (<span class="keywordtype">int</span>)ExpImpMode.IMPORT_TEST_GROUPS_FROM_STARTUP_PROJECT:</div>
<div class="line">                        ImportTestAppsFromCurrentTestGroups();</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> (<span class="keywordtype">int</span>)ExpImpMode.IMPORT_VISIBLE_TEST_FUNCS_FROM_STARTUP_PROJECT:</div>
<div class="line">                        ImportTestAppsFromCurrentTestFuncs();</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                cbxExportImportTestApps.SelectedIndex = 0; <span class="comment">// reset selection to allow mulltiple triggers for same list index</span></div>
<div class="line">                <span class="comment">// Remark: ListItem 0 is declared as invisible (=&quot;collapsed&quot;, see xaml) within list. This item is used to always show the standard text.</span></div>
<div class="line">                <span class="comment">// The combobox is oonly used to trigger an action from the list and not to store and display a current selection!</span></div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartProcess(<span class="keywordtype">string</span> exePath, <span class="keywordtype">string</span> args, <span class="keywordtype">string</span> workDir)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> waitTimeMs = GetMaxWaitTimeInMs();</div>
<div class="line">            <span class="keywordflow">if</span> (waitTimeMs&gt;0)</div>
<div class="line">            {</div>
<div class="line">                m_executionTimer.Interval = waitTimeMs;</div>
<div class="line">                m_executionTimer.Start();</div>
<div class="line">            }</div>
<div class="line">            m_executor.StartProcess(exePath, args, workDir);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">int</span> GetMaxWaitTimeInMs()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (m_waitMode)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_ENDLESS:</div>
<div class="line">                    <span class="keywordflow">return</span> 0;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_30_SEC:</div>
<div class="line">                    <span class="keywordflow">return</span> 30 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_1_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 60 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_2_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 120 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_5_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 300 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_10_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 600 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_20_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 1200 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_30_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 1800 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_40_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 2400 * 1000;</div>
<div class="line">                <span class="keywordflow">case</span> WaitMode.WAIT_60_MIN:</div>
<div class="line">                    <span class="keywordflow">return</span> 3600 * 1000;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">return</span> 3600 * 1000;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnExecutionTimeout(Object myObject, EventArgs myEventArgs)</div>
<div class="line">        {</div>
<div class="line">            m_executionTimer.Stop();</div>
<div class="line">            WriteLine(1, <span class="stringliteral">&quot;TIMEOUT of &quot;</span> + GetMaxWaitTimeInMs()/1000 + <span class="stringliteral">&quot;sec has expired!&quot;</span>);</div>
<div class="line">            m_executor.KillRunningProcess();</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SaveLog(RunMode in_runMode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">string</span> fileName = <span class="stringliteral">&quot;TextExecWin.&quot;</span>;</div>
<div class="line">                <span class="keywordflow">if</span> (in_runMode == RunMode.TEST_APPS)</div>
<div class="line">                {</div>
<div class="line">                    fileName += <span class="stringliteral">&quot;RunTestApps.&quot;</span> + cbxDescTestApps.Text;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in_runMode == RunMode.TEST_GROUPS)</div>
<div class="line">                {</div>
<div class="line">                    fileName += <span class="stringliteral">&quot;RunAllTestGroups.&quot;</span> + txtInfo.Text;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in_runMode == RunMode.TEST_FUNCS)</div>
<div class="line">                {</div>
<div class="line">                    fileName += <span class="stringliteral">&quot;RunAllTestFuncs.&quot;</span> + txtInfo.Text;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in_runMode == RunMode.TEST_STARTUP_PROJECT)</div>
<div class="line">                {</div>
<div class="line">                    fileName += <span class="stringliteral">&quot;SingleRun.&quot;</span> + txtInfo.Text;</div>
<div class="line">                }</div>
<div class="line">                var now = DateTime.Now;</div>
<div class="line">                <span class="keywordtype">string</span> timeStamp = now.ToString(<span class="stringliteral">&quot;yyyy.MM.dd_HH.mm.ss&quot;</span>);</div>
<div class="line">                fileName += <span class="stringliteral">&quot;.&quot;</span> + timeStamp + <span class="stringliteral">&quot;.Log.txt&quot;</span>;</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;SaveLog-fileName=&quot;</span> + fileName);</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">string</span> fileDir = m_projectInfo.targetDirPath;</div>
<div class="line">                <span class="keywordflow">if</span> (fileDir == <span class="stringliteral">&quot;&lt;not set&gt;&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Get the first path found within environment variables TMP, TEMP or USERPROFILE</span></div>
<div class="line">                    fileDir = System.IO.Path.GetTempPath();</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordtype">string</span> fullFilePath = fileDir + <span class="stringliteral">&quot;\\&quot;</span> + fileName;</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;SaveLog-fullFilePath=&quot;</span> + fullFilePath);</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">string</span> fileHeader = <span class="stringliteral">&quot;// Exported from TestExecWin - &quot;</span> + now.ToShortDateString() + <span class="stringliteral">&quot; &quot;</span> + now.ToLongTimeString();</div>
<div class="line">                fileHeader += <span class="stringliteral">&quot;\n// Test project : &quot;</span> + txtInfo.Text;</div>
<div class="line">                fileHeader += <span class="stringliteral">&quot;\n// Source path  : &quot;</span> + m_projectInfo.sourceDirPath;</div>
<div class="line">                fileHeader += <span class="stringliteral">&quot;\n// RunMode      : &quot;</span> + in_runMode + <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;SaveLog-fileHeader=\n&quot;</span> + fileHeader);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Write list contents to file</span></div>
<div class="line">                System.IO.File.WriteAllText(fullFilePath, fileHeader + GetListBoxItemsAsText(lstEvents));</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;SaveLog-EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CheckForFinalAction(RunMode in_runMode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">bool</span> shutdown = (bool)chkShutdown.IsChecked;</div>
<div class="line">                if (shutdown)</div>
<div class="line">                {</div>
<div class="line">                    SaveLog(in_runMode);</div>
<div class="line"></div>
<div class="line">                    <span class="keywordtype">bool</span> reallyShutdown = <span class="keyword">true</span>; <span class="comment">// deactivate for testing</span></div>
<div class="line">                    <span class="keywordflow">if</span> (reallyShutdown)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Possible extension: First check for existence of predefined batch file to perform specific shutdown actions</span></div>
<div class="line">                        <span class="comment">//string nameBatchFile=&quot;TestExecWin.Shutdown.cmd&quot;;</span></div>
<div class="line">                        <span class="comment">//string foundBatchFilePath = &quot;&quot;;</span></div>
<div class="line">                        <span class="comment">//System.Collections.Generic.List&lt;string&gt; possibleFilePaths = new System.Collections.Generic.List&lt;string&gt;();</span></div>
<div class="line">                        <span class="comment">//if (m_projectInfo.targetDirPath != &quot;&lt;not set&gt;&quot;)</span></div>
<div class="line">                        <span class="comment">//{</span></div>
<div class="line">                        <span class="comment">//    possibleFilePaths.Add(m_projectInfo.targetDirPath);</span></div>
<div class="line">                        <span class="comment">//}</span></div>
<div class="line">                        <span class="comment">//possibleFilePaths.Add(System.IO.Path.GetTempPath());</span></div>
<div class="line">                        <span class="comment">//foreach (string fileDir in possibleFilePaths)</span></div>
<div class="line">                        <span class="comment">//{</span></div>
<div class="line">                        <span class="comment">//    string tmpPath = fileDir + nameBatchFile;</span></div>
<div class="line">                        <span class="comment">//    if (System.IO.File.Exists(tmpPath))</span></div>
<div class="line">                        <span class="comment">//    {</span></div>
<div class="line">                        <span class="comment">//        foundBatchFilePath = tmpPath;</span></div>
<div class="line">                        <span class="comment">//        break;</span></div>
<div class="line">                        <span class="comment">//    }</span></div>
<div class="line">                        <span class="comment">//    WriteLine(1, &quot;Batch not found: &quot; + tmpPath);</span></div>
<div class="line">                        <span class="comment">//}</span></div>
<div class="line">                        <span class="comment">//if (foundBatchFilePath.Length&gt;0)</span></div>
<div class="line">                        <span class="comment">//{</span></div>
<div class="line">                        <span class="comment">//    WriteLine(1, &quot;Trying to shutdown with &quot; + foundBatchFilePath + &quot;...&quot;);</span></div>
<div class="line">                        <span class="comment">//    Process.Start(foundBatchFilePath);</span></div>
<div class="line">                        <span class="comment">//}</span></div>
<div class="line">                        <span class="comment">//else</span></div>
<div class="line">                        {</div>
<div class="line">                            <span class="comment">// WriteLine(1, &quot;No predefined batch file found, now trying to shutdown with simple shutdown command...&quot;);</span></div>
<div class="line">                            WriteLine(1, <span class="stringliteral">&quot;Now trying to shutdown with simple command shutdown /s /f ...&quot;</span>);</div>
<div class="line">                            Process.Start(<span class="stringliteral">&quot;shutdown&quot;</span>, <span class="stringliteral">&quot;/s /f /t 0&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        WriteLine(1, <span class="stringliteral">&quot;Shutdown is skipped&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;CheckForFinalAction-EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> chkShutdown_CheckBoxChanged(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> selectedForShutdown = (bool)chkShutdown.IsChecked;</div>
<div class="line">            if (selectedForShutdown)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.Media.SolidColorBrush shutDownColor = System.Windows.Media.Brushes.Yellow;</div>
<div class="line">                this.Background = shutDownColor;</div>
<div class="line">                mainGrid.Background = shutDownColor;</div>
<div class="line">                tabControl.Background = shutDownColor;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                this.Background = m_originalBrushWindow;</div>
<div class="line">                mainGrid.Background = m_originalBrushWindow;</div>
<div class="line">                tabControl.Background = m_originalBrushWindow;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 4 2019 13:44:51 for TestExecWindow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
