<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>TestExecWindow: VisualStudioConnector.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MyStyles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TestExecWindow
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___grp_source_visual_studio_connector.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">VisualStudioConnector.cs<div class="ingroups"><a class="el" href="group___grp_design.html">Internal Design</a> &raquo; <a class="el" href="group___grp_sources.html">Source files</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Copyright(C) 2016  Gerald Fahrnholz</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">//    it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><span class="comment">//    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment">//    (at your option) any later version.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><span class="comment">//    GNU General Public License for more details.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    You should have received a copy of the GNU General Public License</span></div>
<div class="line"><span class="comment">//    along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    Contact: http://www.gerald-fahrnholz.eu/impressum.php</span></div>
<div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using</span> System;</div>
<div class="line"><span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><span class="keyword">using</span> System.Linq;</div>
<div class="line"><span class="keyword">using</span> System.Text;</div>
<div class="line"><span class="keyword">using</span> System.Threading.Tasks;</div>
<div class="line"><span class="keyword">using</span> Microsoft.VisualStudio.Shell.Interop;</div>
<div class="line"><span class="keyword">using</span> Microsoft.VisualStudio;</div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>TestExecWin</div>
<div class="line">{<span class="comment"></span></div>
<div class="line"><span class="comment">    /// [derive from notification interfaces]</span></div>
<div class="line"><span class="comment">    /// Class derives from notification interfaces to get</span></div>
<div class="line"><span class="comment">    /// informed when user performs changes within Visual Studio.</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">class </span>VisualStudioConnector </div>
<div class="line">        : Microsoft.VisualStudio.Shell.Interop.IVsSelectionEvents</div>
<div class="line">        , Microsoft.VisualStudio.Shell.Interop.IVsUpdateSolutionEvents<span class="comment"></span></div>
<div class="line"><span class="comment">    /// [derive from notification interfaces]</span></div>
<div class="line"><span class="comment"></span>    {</div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> EnvDTE80.DTE2 dte;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> EnvDTE.Project m_startupProj = null;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> IVsMonitorSelection m_monitorSelection = null;</div>
<div class="line">        <span class="keyword">private</span> uint m_selectionEventsCookie = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> IVsSolutionBuildManager m_solutionBuildManager = null;</div>
<div class="line">        <span class="keyword">private</span> uint m_updateSolutionEventsCookie = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> IMainEvents m_mainEvents;</div>
<div class="line">        <span class="keyword">private</span> IEventReceiver m_evenReceiver;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">public</span> VisualStudioConnector(IMainEvents in_mainEvents, IEventReceiver in_eventReceiver)</div>
<div class="line">        {</div>
<div class="line">            m_mainEvents = in_mainEvents;</div>
<div class="line">            m_evenReceiver = in_eventReceiver;</div>
<div class="line">            ConnectWithVisualStudio();</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [connect with VS]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">private</span> <span class="keywordtype">void</span> ConnectWithVisualStudio()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> connectedToSelectionEvents = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">bool</span> connectedToUpdateSolutionEvents = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Advise to selection events (e.g. startup project changed)</span></div>
<div class="line">            m_monitorSelection = Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider.</div>
<div class="line">                GetService(typeof(SVsShellMonitorSelection)) as IVsMonitorSelection;</div>
<div class="line">            if (m_monitorSelection != null)</div>
<div class="line">            {</div>
<div class="line">                m_monitorSelection.AdviseSelectionEvents(</div>
<div class="line">                    <span class="keyword">this</span>, out m_selectionEventsCookie);</div>
<div class="line">                connectedToSelectionEvents = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;ConnectWithVisualStudio: GetService(SVsShellMonitorSelection) failed!&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Advise to update solution events (e.g. switched debug/release configuration)</span></div>
<div class="line">            m_solutionBuildManager = Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider.</div>
<div class="line">                GetService(typeof(SVsSolutionBuildManager)) as IVsSolutionBuildManager;</div>
<div class="line">            if (m_solutionBuildManager != null)</div>
<div class="line">            {</div>
<div class="line">                m_solutionBuildManager.AdviseUpdateSolutionEvents(</div>
<div class="line">                    <span class="keyword">this</span>, out m_updateSolutionEventsCookie);</div>
<div class="line">                connectedToUpdateSolutionEvents = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;ConnectWithVisualStudio: GetService(SVsSolutionBuildManager) failed!&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (connectedToSelectionEvents &amp;&amp; connectedToUpdateSolutionEvents)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;ConnectWithVisualStudio succeeded&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [connect with VS]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [disconnect from VS]</span></div>
<div class="line"><span class="comment">        /// Release all connections to Visual Studio.</span></div>
<div class="line"><span class="comment">        /// This function is called from Dispose method of main app class TestExecWindow</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> DisconnectFromVisualStudio()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (m_monitorSelection != null &amp;&amp; m_selectionEventsCookie != 0)</div>
<div class="line">                m_monitorSelection.UnadviseSelectionEvents(m_selectionEventsCookie);</div>
<div class="line">            <span class="keywordflow">if</span> (m_solutionBuildManager != null &amp;&amp; m_updateSolutionEventsCookie != 0)</div>
<div class="line">                m_solutionBuildManager.UnadviseUpdateSolutionEvents(m_updateSolutionEventsCookie);</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [disconnect from VS]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// Read all relevant project settings</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> ReadSettingsOfStartupProject(ProjectInfo projectInfo)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-Begin&quot;</span>);</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (dte == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte is null (checking for startup project is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution is null (checking for startup project is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution.SolutionBuild == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution.SolutionBuild is null (checking for startup project is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution.SolutionBuild.ActiveConfiguration == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution.SolutionBuild.ActiveConfiguration is null (checking for startup project is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                projectInfo.solutionFullPath = dte.Solution.FileName;</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get config name]</span></div>
<div class="line"><span class="comment"></span>                <span class="comment">//Get name of config (e.g. &quot;Debug&quot;, &quot;Release&quot;</span></div>
<div class="line">                <span class="keywordtype">string</span> configName = dte.Solution.SolutionBuild.ActiveConfiguration.Name;<span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get config name]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">                <span class="keywordtype">string</span> msg = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get name startup project]</span></div>
<div class="line"><span class="comment"></span>                EnvDTE80.SolutionBuild2 sb = (EnvDTE80.SolutionBuild2)dte.Solution.SolutionBuild;</div>
<div class="line">                if (sb == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;SolutionBuild is null (checking for startup project is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// sb.StartupProjects is an array of project file names. Usually we expect</span></div>
<div class="line">                <span class="comment">// only a single project name within the array.</span></div>
<div class="line">                <span class="comment">// Name is of the format &quot;..\Test\TestRunner\TestRunner.vcxproj&quot;</span></div>
<div class="line">                <span class="keywordflow">if</span> (sb.StartupProjects == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(2, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End: StartupProjects not available&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">foreach</span> (String item <span class="keywordflow">in</span> (Array)sb.StartupProjects)</div>
<div class="line">                {</div>
<div class="line">                    msg += item;</div>
<div class="line">                }</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;startupProjects=&quot;</span> + msg);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// for further processing extract the name without path and extension</span></div>
<div class="line">                <span class="comment">// e.g. nameStartupProject = &quot;TestRunner&quot;</span></div>
<div class="line">                <span class="comment">// (extraction code not shown here)</span><span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get name startup project]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">                <span class="keywordtype">int</span> posLast = msg.LastIndexOf(<span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (posLast &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    msg = msg.Substring(0, posLast);</div>
<div class="line">                }</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;startupProjects=&quot;</span> + msg);</div>
<div class="line">                <span class="keywordtype">int</span> posFirst = msg.LastIndexOf(<span class="stringliteral">&quot;\\&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (posFirst &gt;= 0)</div>
<div class="line">                {</div>
<div class="line">                    msg = msg.Substring(posFirst + 1);</div>
<div class="line">                }</div>
<div class="line">                String nameStartupProject = msg;</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;nameStartupProject=&quot;</span> + nameStartupProject);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// To simple solution which does not work for startup projects within a filter</span></div>
<div class="line">                <span class="comment">//EnvDTE.Project startupProj = dte.Solution.Item(msg);</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get startup project]</span></div>
<div class="line"><span class="comment"></span>                <span class="comment">// Perform recursive search for the startup project through all solution filters:</span></div>
<div class="line">                EnvDTE.Project startupProj = FindProject(nameStartupProject);<span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get startup project]</span></div>
<div class="line"><span class="comment"></span>                <span class="keywordflow">if</span> (startupProj == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;No startup project found&quot;</span>);</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End: no startup project found&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                m_startupProj = startupProj;</div>
<div class="line"></div>
<div class="line">                projectInfo.project = startupProj.Name;</div>
<div class="line">                projectInfo.config = configName;</div>
<div class="line">                projectInfo.sourceDirPath = System.IO.Path.GetDirectoryName(startupProj.FullName);</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;ReadSettingsOfStartupProject: project=&quot;</span> + projectInfo.project + <span class="stringliteral">&quot; - &quot;</span> + projectInfo.config);</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;ReadSettingsOfStartupProject: projectPath=&quot;</span> + projectInfo.sourceDirPath);</div>
<div class="line"></div>
<div class="line">                EnvDTE.ConfigurationManager cm = startupProj.ConfigurationManager;</div>
<div class="line">                <span class="keywordflow">if</span> (cm == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;No ConfigurationManager found&quot;</span>);</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End: no ConfigurationManager found&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (cm.ActiveConfiguration == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;No ActiveConfiguration found&quot;</span>);</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End: no ActiveConfiguration found&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                msg = <span class="stringliteral">&quot;Platform=&quot;</span> + cm.ActiveConfiguration.PlatformName;</div>
<div class="line">                WriteLine(2, msg);</div>
<div class="line"></div>
<div class="line">                EnvDTE.Properties props = cm.ActiveConfiguration.Properties;</div>
<div class="line">                <span class="keywordflow">if</span> (props != null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(2, <span class="stringliteral">&quot;Now iterating over ActiveConfiguration.Properties...&quot;</span>);</div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Scan properties of ActiveConfiguration to be used for future extended requests</span></div>
<div class="line">                    msg = <span class="stringliteral">&quot;ReadSettingsOfStartupProject: ActiveConfiguration.Properties&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">foreach</span> (EnvDTE.Property p in props)</div>
<div class="line">                    {</div>
<div class="line">                        msg += <span class="stringliteral">&quot;  &quot;</span> + p.Name;</div>
<div class="line">                    }</div>
<div class="line">                    WriteLine(2, msg);</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//projectInfo.targetDirPath = startupProj.ConfigurationManager.ActiveConfiguration.Properties.Item(&quot;OutputPath&quot;).Value.ToString();</span></div>
<div class="line">                <span class="comment">//msg = &quot;ReadSettingsOfStartupProject: OutputPath=&quot; + projectInfo.targetDirPath;</span></div>
<div class="line">                <span class="comment">//WriteLine(2, msg);</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get exe path]</span></div>
<div class="line"><span class="comment"></span>                <span class="comment">// Get full path of executable depending on found</span></div>
<div class="line">                <span class="comment">// startup project and configuration (Debug/Release)</span></div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.VCProject vcProj =</div>
<div class="line">                    (Microsoft.VisualStudio.VCProjectEngine.VCProject)startupProj.Object;</div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.IVCCollection configs =</div>
<div class="line">                    (Microsoft.VisualStudio.VCProjectEngine.IVCCollection)vcProj.Configurations;</div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.VCConfiguration config =</div>
<div class="line">                    FindConfig(configs, configName);</div>
<div class="line">                <span class="keywordflow">if</span> (config == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;Config &quot;</span> + configName + <span class="stringliteral">&quot; not found&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">                }</div>
<div class="line">                msg = <span class="stringliteral">&quot;PrimaryOutput (FullExePath)=&quot;</span> + config.PrimaryOutput;</div>
<div class="line">                WriteLine(2, msg);<span class="comment"></span></div>
<div class="line"><span class="comment">                /// [get exe path]</span></div>
<div class="line"><span class="comment"></span>                projectInfo.fullExePath = config.PrimaryOutput;</div>
<div class="line">                <span class="keywordtype">string</span> delimiter = <span class="stringliteral">&quot;/\\&quot;</span>;</div>
<div class="line">                <span class="keywordtype">int</span> posPathEnd = projectInfo.fullExePath.LastIndexOfAny(delimiter.ToCharArray());</div>
<div class="line">                <span class="keywordflow">if</span> (posPathEnd &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    projectInfo.targetDirPath = projectInfo.fullExePath.Substring(0, posPathEnd);</div>
<div class="line">                }</div>
<div class="line">                msg = <span class="stringliteral">&quot;ReadSettingsOfStartupProject: OutputPath=&quot;</span> + projectInfo.targetDirPath;</div>
<div class="line">                WriteLine(2, msg);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// Scan properties to be used for future extended requests</span></div>
<div class="line">                msg = <span class="stringliteral">&quot;ReadSettingsOfStartupProject: startupProj.Properties&quot;</span>;</div>
<div class="line">                <span class="keywordflow">foreach</span> (EnvDTE.Property p in startupProj.Properties)</div>
<div class="line">                {</div>
<div class="line">                    msg += <span class="stringliteral">&quot;  &quot;</span> + p.Name;</div>
<div class="line">                }</div>
<div class="line">                WriteLine(3, msg);</div>
<div class="line">                <span class="comment">//msg = &quot;ReadSettingsOfStartupProject: ActiveConfiguration.Properties&quot;;</span></div>
<div class="line">                <span class="comment">//foreach (EnvDTE.Property p in startupProj.ConfigurationManager.ActiveConfiguration.Properties)</span></div>
<div class="line">                <span class="comment">//{</span></div>
<div class="line">                <span class="comment">//    msg += &quot;  &quot; + p.Name;</span></div>
<div class="line">                <span class="comment">//}</span></div>
<div class="line">                <span class="comment">//WriteLine(3, msg);</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">//msg = &quot;CommandArguments=&quot;;</span></div>
<div class="line">                <span class="comment">//msg += startupProj.ConfigurationManager.ActiveConfiguration.Properties.Item(&quot;CommandArguments&quot;).Value.ToString();</span></div>
<div class="line">                <span class="comment">//WriteLine(3, msg);</span></div>
<div class="line"></div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;ReadSettingsOfStartupProject-End: EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [start debugging]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> StartDebugging(<span class="keywordtype">string</span> in_cmdLineParams)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (m_startupProj != null)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">//m_startupProj.ConfigurationManager.ActiveConfiguration.Properties.</span></div>
<div class="line">                    <span class="comment">//    Item(&quot;CommandArguments&quot;).Value = in_cmdLineParams;</span></div>
<div class="line">                    <span class="keywordtype">string</span> configName = dte.Solution.SolutionBuild.ActiveConfiguration.Name;</div>
<div class="line">                    Microsoft.VisualStudio.VCProjectEngine.VCProject vcProj =</div>
<div class="line">                        (Microsoft.VisualStudio.VCProjectEngine.VCProject)m_startupProj.Object;</div>
<div class="line">                    Microsoft.VisualStudio.VCProjectEngine.IVCCollection configs =</div>
<div class="line">                        (Microsoft.VisualStudio.VCProjectEngine.IVCCollection)vcProj.Configurations;</div>
<div class="line">                    Microsoft.VisualStudio.VCProjectEngine.VCConfiguration config =</div>
<div class="line">                        FindConfig(configs, configName);</div>
<div class="line">                    Microsoft.VisualStudio.VCProjectEngine.VCDebugSettings dbgSettings =</div>
<div class="line">                        (Microsoft.VisualStudio.VCProjectEngine.VCDebugSettings)config.DebugSettings;</div>
<div class="line">                    dbgSettings.CommandArguments = in_cmdLineParams;</div>
<div class="line"></div>
<div class="line">                    WriteLine(2, <span class="stringliteral">&quot;StartDebugging: now starting debugger with dbgSettings.CommandArguments=&quot;</span> + dbgSettings.CommandArguments);</div>
<div class="line">                    dte.Debugger.Go(<span class="keyword">false</span> <span class="comment">/* do not wait for end of debugging*/</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;Could not start debugging\nEXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [start debugging]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [open text file]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> OpenFile(<span class="keywordtype">string</span> in_fullFilePath, <span class="keywordtype">int</span> in_lineNum = 0)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;OpenFile &quot;</span> + in_fullFilePath + <span class="stringliteral">&quot; line &quot;</span> + in_lineNum);</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                dte.ItemOperations.OpenFile(in_fullFilePath, EnvDTE.Constants.vsViewKindTextView);</div>
<div class="line">                <span class="keywordflow">if</span> (in_lineNum&gt;0)</div>
<div class="line">                {</div>
<div class="line">                    dte.ExecuteCommand(<span class="stringliteral">&quot;Edit.Goto&quot;</span>,in_lineNum.ToString());</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;Could not open file &quot;</span> + in_fullFilePath + <span class="stringliteral">&quot;\nEXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">            }</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [open text file]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">string</span> GetExecutablesFromCurrentSolution()</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;GetExecutablesFromCurrentSolution-Begin&quot;</span>);</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (dte == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte is null (checking for projects is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution is null (checking for projects is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution.SolutionBuild == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution.SolutionBuild is null (checking for projects is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (dte.Solution.SolutionBuild.ActiveConfiguration == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(1, <span class="stringliteral">&quot;dte.Solution.SolutionBuild.ActiveConfiguration is null (checking for projects is not possible)&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">string</span> configName = dte.Solution.SolutionBuild.ActiveConfiguration.Name;</div>
<div class="line"></div>
<div class="line">                var projects = dte.Solution.Projects;</div>
<div class="line">                <span class="keywordflow">if</span> (projects==null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(2, <span class="stringliteral">&quot;GetExecutablesFromCurrentSolution-End: projects not available&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                List&lt;string&gt; executables = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line">                <span class="keywordflow">foreach</span> (EnvDTE.Project project in projects)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (project != null)</div>
<div class="line">                    {</div>
<div class="line">                        AddProjectRecursive(project, configName, executables);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                WriteLine(2, <span class="stringliteral">&quot;GetExecutablesFromCurrentSolution-End numExecutablesFound=&quot;</span> + executables.Count);</div>
<div class="line">                executables.Sort();</div>
<div class="line">                <span class="keywordtype">string</span> executablesAsString = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> executable <span class="keywordflow">in</span> executables)</div>
<div class="line">                {</div>
<div class="line">                    executablesAsString += executable + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> executablesAsString;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception ex)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(1, <span class="stringliteral">&quot;GetExecutablesFromCurrentSolution-End: EXCEPTION: &quot;</span> + ex.ToString());</div>
<div class="line">                <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddProjectRecursive(EnvDTE.Project project, <span class="keywordtype">string</span> configName, List&lt;string&gt; foundExecutables)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (project == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive: found project.Name= &quot;</span> + project.Name + <span class="stringliteral">&quot; project.Kind=&quot;</span> + project.Kind);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (project.Kind == EnvDTE.Constants.vsProjectKindSolutionItems)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive: found solution item &quot;</span> + project.Name);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">foreach</span> (EnvDTE.ProjectItem item in project.ProjectItems)</div>
<div class="line">                {</div>
<div class="line">                    EnvDTE.Project realProject = item.Object as EnvDTE.Project;</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> (realProject != null)</div>
<div class="line">                    {</div>
<div class="line">                        AddProjectRecursive(realProject, configName, foundExecutables);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="comment">// may be real project</span></div>
<div class="line">            {</div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.VCProject vcProj = (Microsoft.VisualStudio.VCProjectEngine.VCProject)project.Object;</div>
<div class="line">                if (vcProj == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive/may be real project: vcProj == null&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.IVCCollection configs = (Microsoft.VisualStudio.VCProjectEngine.IVCCollection)vcProj.Configurations;</div>
<div class="line">                Microsoft.VisualStudio.VCProjectEngine.VCConfiguration config = FindConfig(configs, configName);</div>
<div class="line">                <span class="keywordflow">if</span> (config == null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive/may be real project: config == null&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordtype">string</span> outputPath = config.PrimaryOutput;</div>
<div class="line">                outputPath.Trim();</div>
<div class="line">                <span class="keywordtype">string</span> tmpOutputPath = outputPath.ToLower();</div>
<div class="line">                <span class="keywordflow">if</span> ((tmpOutputPath.Length &gt; 0) &amp;&amp; (tmpOutputPath.IndexOf(<span class="stringliteral">&quot;.exe&quot;</span>) == tmpOutputPath.Length - 4))</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive: Found project: &quot;</span> + project.Name + <span class="stringliteral">&quot; exe: &quot;</span> + outputPath);</div>
<div class="line">                    foundExecutables.Add(outputPath);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;AddProjectRecursive: Ignored project: &quot;</span> + project.Name + <span class="stringliteral">&quot; is no exe: &quot;</span> + outputPath);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [listen to changed startup project]</span></div>
<div class="line"><span class="comment"></span>        <span class="comment">// -----  Interface IVsSelectionEvents  -----</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// Check for notification about changed startup project</span></div>
<div class="line">        <span class="keywordtype">int</span> IVsSelectionEvents.OnElementValueChanged(</div>
<div class="line">        uint elementid, <span class="keywordtype">object</span> varValueOld, <span class="keywordtype">object</span> varValueNew)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (elementid == (uint)VSConstants.VSSELELEMID.SEID_StartupProject)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// When startup project is set in solution explorer a complete refresh is triggered</span></div>
<div class="line">                <span class="keywordflow">if</span> (varValueNew != null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(2, <span class="stringliteral">&quot;Detected new StartupProject&quot;</span>);</div>
<div class="line">                    m_mainEvents.OnRefreshAll();</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// All other events from IVsSelectionEvents are ignored.</span></div>
<div class="line">        <span class="comment">// Eventhandler functions simply return OK status.</span></div>
<div class="line">        <span class="keywordtype">int</span> IVsSelectionEvents.OnCmdUIContextChanged(</div>
<div class="line">            uint dwCmdUICookie, <span class="keywordtype">int</span> fActive)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// ...</span></div>
<div class="line"><span class="comment">        /// [listen to changed startup project]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">        <span class="keywordtype">int</span> IVsSelectionEvents.OnSelectionChanged(IVsHierarchy pHierOld, uint itemidOld, IVsMultiItemSelect pMISOld, ISelectionContainer pSCOld, IVsHierarchy pHierNew, uint itemidNew, IVsMultiItemSelect pMISNew, ISelectionContainer pSCNew)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [listen to switched debug/release configuration]</span></div>
<div class="line"><span class="comment"></span>        <span class="comment">// -----  Interface IVsUpdateSolutionEvents  -----</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> IVsUpdateSolutionEvents.OnActiveProjectCfgChange(IVsHierarchy pIVsHierarchy)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(2, <span class="stringliteral">&quot;Detected OnActiveProjectCfgChange&quot;</span>);</div>
<div class="line">            m_mainEvents.OnRefreshAll();</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [listen to switched debug/release configuration]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">        <span class="comment">// All other events from IVsSelectionEvents are ignored.</span></div>
<div class="line">        <span class="comment">// Eventhandler functions simply return OK status.</span></div>
<div class="line">        <span class="keywordtype">int</span> IVsUpdateSolutionEvents.UpdateSolution_Begin(ref <span class="keywordtype">int</span> pfCancelUpdate)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> IVsUpdateSolutionEvents.UpdateSolution_Done(<span class="keywordtype">int</span> fSucceeded, <span class="keywordtype">int</span> fModified, <span class="keywordtype">int</span> fCancelCommand)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> IVsUpdateSolutionEvents.UpdateSolution_StartUpdate(ref <span class="keywordtype">int</span> pfCancelUpdate)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> IVsUpdateSolutionEvents.UpdateSolution_Cancel()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> VSConstants.S_OK;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// -----  Private methods  -----</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// Find a project with a given name within the hierarchical tree of project/solution items</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">private</span> EnvDTE.Project FindProject(<span class="keywordtype">string</span> nameProject)</div>
<div class="line">        {<span class="comment"></span></div>
<div class="line"><span class="comment">            /// [iterate dte projects]</span></div>
<div class="line"><span class="comment"></span>            <span class="keywordflow">foreach</span> (EnvDTE.Project project in dte.Solution.Projects)<span class="comment"></span></div>
<div class="line"><span class="comment">            /// [iterate dte projects]</span></div>
<div class="line"><span class="comment"></span>            {</div>
<div class="line">                <span class="keywordflow">if</span> (project != null)</div>
<div class="line">                {</div>
<div class="line">                    WriteLine(3, <span class="stringliteral">&quot;FindProject: &quot;</span> + project.Name);</div>
<div class="line">                    <span class="keywordflow">if</span> (project.Kind == EnvDTE.Constants.vsProjectKindSolutionItems)</div>
<div class="line">                    {</div>
<div class="line">                        EnvDTE.Project projectNextLevel = FindProjectRecursive(project, nameProject);</div>
<div class="line">                        <span class="keywordflow">if</span> (projectNextLevel != null)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">return</span> projectNextLevel;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (project.Name == nameProject)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span> project;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> null;</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// Find a project with a given name within the project items of a given project</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">private</span> EnvDTE.Project FindProjectRecursive(EnvDTE.Project project, <span class="keywordtype">string</span> nameProject)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (project == null)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> null;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;FindProjectRecursive: &quot;</span> + project.Name);</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">            /// [recursive search]</span></div>
<div class="line"><span class="comment"></span>            <span class="keywordflow">foreach</span> (EnvDTE.ProjectItem item in project.ProjectItems)</div>
<div class="line">            {</div>
<div class="line">                EnvDTE.Project realProject = item.Object as EnvDTE.Project;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (realProject != null)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (realProject.Kind == EnvDTE.Constants.vsProjectKindSolutionItems)</div>
<div class="line">                    {</div>
<div class="line">                        EnvDTE.Project projectNextLevel = FindProjectRecursive(</div>
<div class="line">                            realProject, nameProject);</div>
<div class="line">                        <span class="keywordflow">if</span> (projectNextLevel != null)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">return</span> projectNextLevel;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (realProject.Name == nameProject)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span> realProject;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }<span class="comment"></span></div>
<div class="line"><span class="comment">            /// [recursive search]</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">            <span class="keywordflow">return</span> null;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> WriteLine(<span class="keywordtype">int</span> in_outputLevel, String in_info)</div>
<div class="line">        {</div>
<div class="line">            m_evenReceiver.WriteLine(in_outputLevel, in_info);</div>
<div class="line">        }</div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /// [find config]</span></div>
<div class="line"><span class="comment"></span>        <span class="keyword">private</span> Microsoft.VisualStudio.VCProjectEngine.VCConfiguration FindConfig(Microsoft.VisualStudio.VCProjectEngine.IVCCollection in_configurations, String in_configName)</div>
<div class="line">        {</div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;FindConfig: searching for config &quot;</span> + in_configName);</div>
<div class="line">            <span class="keywordflow">if</span> ((in_configurations == null) || (in_configurations.Count &lt;= 0))</div>
<div class="line">            {</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;FindConfig: in_configurations is null or empty&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> null;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            WriteLine(3, <span class="stringliteral">&quot;FindConfig: configurations.Count=&quot;</span> + in_configurations.Count);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span> (Microsoft.VisualStudio.VCProjectEngine.VCConfiguration configItem in in_configurations)</div>
<div class="line">            {</div>
<div class="line">                WriteLine(3, <span class="stringliteral">&quot;FindConfig: configItem.Name=&gt;&quot;</span> + configItem.Name + <span class="stringliteral">&quot;&lt; .ConfigurationName=&gt;&quot;</span> + configItem.ConfigurationName + <span class="stringliteral">&quot;&lt;&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (configItem.ConfigurationName == in_configName)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span> configItem;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> null;</div>
<div class="line">        }<span class="comment"></span></div>
<div class="line"><span class="comment">        /// [find config]</span></div>
<div class="line"><span class="comment"></span>    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 4 2019 13:44:51 for TestExecWindow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
